<html>
<head>
    <title>KitServer 5.2 Manual</title>
    <style>
        img { display:block;margin:10px 0 10px 0;border:1px solid #000; }
        div.note { background-color:#ffc;color:#800;padding:5px; }
        table {padding:10px 0 10px 0}
        table td {padding:5px;border:1px solid #000}
        table th {padding:5px;border:1px solid #000;background-color:#ccc}
        span.kitid {color:#080;font-style:italic}
        pre {background-color:#ddf;border-top:1px solid #88a;border-bottom:1px solid #88a}
        h3,h4 {background-color:#ccd;display:block;padding:5px;font-family:verdana,arial}
        h2 {display:block;padding:5px 0 5px 0;font-family:verdana,arial;border-bottom:3px solid #88a}
        div,span,p,li {font-family:verdana,arial;}
        li {margin-bottom:10px;}
        table {font-family:verdana,arial;}
        table.shpal td {padding:5px 20px 5px 0;border-bottom:1px solid #000;
            border-top:none;border-left:none;border-right:none}
        table.shpal td.top {border-top:1px solid #000}
        span.soft {font-weight:bold;color:#696;}
        span.ex {font-weight:bold;color:#669;}
    </style>
</head>
<body>
<h2>Руководство для KitServer 5.2</h2>
<div>
9 Августа 2006 г.<br />
Модули: <a href="#kitserver">KitServer: 5.2.3</a>, 
<a href="#ballserver">BallServer: 5.2.3</a>, 
<a href="#faceserver">Faceserver: 5.2.3</a>, 
<a href="#stadium">Stadium Server 5.2.3</a>,
<a href="#lodmixer">LOD Mixer: 5.2.3</a>
</div>

<h3>1.1. Введение</h3>
<p>
Kitserver 5.2 - это дополнительная программа для Pro Evolution Soccer 5, Winning Eleven 9 и Winning Eleven 9 Liveware Evolution, состоящая из нескольких отдельных независимых модулей. С данной версией поставляются пять модулей: Китсервер, LODmixer, Ballserver (сервер мячей), Faceserver (сервер лиц) и Stadium Server. Модуль Китсервер предоставляет альтернативный способ для управления формами вратарей и полевых игроков вне игрового AFS файла. PNG и BMP изображения форм организуются во внешнюю базу данных, которая представляет собой набор папок и файлов соответствующих нескольким простым правилам. Программа не ограничивает количество форм только домашней и выездной, вы можете иметь столько, сколько захотите. Модуль LODmixer позволяет контролировать отдельные аспекты графического движка - такие как: уровень детализации моделей игроков, присутствие зрителей на стадионах, погода в режимах League/Cup/Master League. Модуль Ballserver позволяет добавлять в игру дополнительные мячи. Модуль Faceserver - лица, ну а Stadium Server - стадионы.
</p>

<h3>1.2. Установка</h3>

<p>
Все как обычно: скопируйте полностью папку kitserver в игровую папку, так как показано на рисунке:
</p>

<img src="install.jpg" />

<p>
Войдите в папку kitserver и запустите setup.exe. "PES5.exe" в выпадающем списке будет выбран автоматически, поэтому просто нажмите кнопку "Install". Kitserver должен выдать сообщение о том, что инсталяция прошла успешно. (Если вы получили сообщение об ошибке, удостоверьтесь что игра в данный момент не запущена и PES5.exe не помечен только на чтение).
</p>


<h3>1.3. Деинсталляция</h3>

<p>
Войдите в папку kitserver и запустите setup.exe. "PES5.exe" в выпадающем списке будет выбран автоматически (выберите его, если это не так). Нажмите кнопку "Remove". Kitserver должен показать сообщение об успешной деинсталляции. Теперь, если вы хотите, вы можете удалить папку Kitserver полностью. (Также вы можете просто оставить ее на месте - она не причинит никакого вреда, и это даст вам возможность быстро переустановить Kitserver позже, если вы запустите setup.exe и нажмете кнопку "Install") 
</p>

<h2 id="kitserver">Китсервер (Kitserver Module) 5.2.3</h2>

<h3>2.1 Краткий обзор возможностей модуля</h3>
<p>
<li><b>Отображение 2.5D форм на экране "Strip Selection".</b><br />
(2.5D означает, что эти миниформы отображаются в 2-х измерениях, но созданы из настоящих текстур форм, используемых в игре).</li>
<li><b>Дополнительные формы полевых игроков.</b><br />
Теперь возможно использовать не только 1-ю и 2-ю формы, но и 3-ю, 4-ю и т.д. Также можно комбинировать части форм, имеющих общую палитру (Более подробно про общие палитры ниже в документе). Дополнительные формы голкиперов будут поддерживаться в следующей версии.</li>
<li><b>Новая структура базы данных.</b><br />
"KDB" переименована в "GDB" (Graphics DataBase) и теперь содержит не только формы, но также мячи и лица. Внутренняя структура полностью обновлена. Старая структура плохо подходила для использования дополнительных форм, новая же является достаточно гибкой. Когда вы привыкнете к ней, вы заметите, что она гораздо удобнее, чем KDB из Kitserver 5.0.</li>
<li>
<b>Поддержка 24-х и 32-х битовых изображений (High-Definition kits)</b>
Существенна изменена внутренняя структура модуля и теперь проблема "общей палитры" больше 
не существует. Вы можете свободно смешивать любые формы, а также использовать 256-цветные изображения с палитрой, 24-битные или 32-битные с альфа-каналом.
</li>
</p>

<div class="note">
В данном документе, в качестве примера взята версия игры Pro Evolution Soccer 5, однако
вся информация также применима и к Winning Eleven 9 и к Winning Eleven 9 Liveware Evolution.
Просто не забывайте, что названия файлов могут немного различаться. Например, исполняемый
файл в PES5 называется <b>PES5.exe</b>, в WE9 - <b>we9.exe</b>, а в WE9:LE - <b>WE9LEK.exe</b>.
</div>


<h3>2.2. Организация графической базы данных (GDB)</h3>
<p>
GDB является наибольшим изменением в работе Kitserver по сравнению с версией 5.0. GDB содержит папку uni, которая отвечает за хранение форм команд (униформ). Важнейший файл в папке <b>uni</b> называется <b>map.txt</b>. Этот файл содержит информацию, где Kitserver должен искать формы для отдельной команды. Как вы знаете, каждая команда имеет свой собственный уникальный id - целое число от 0 до 201 (+несколько дополнительных команд "всех звезд"). Поэтому для каждой команды в GDB вы должны назначить, где формы для этой команды, в файле <b>map.txt</b>. Вот пример:

<pre>
# This config maps team number into folder name
# Format: &lt;team-num&gt;,"&lt;folder name&gt;"
# Example: 21,"Russia"

8,"National\France"
9,"National\Germany"
65,"EPL\Aston_Villa"
75,"EPL\Man Utd"
77,"EPL\Newcastle"
80,"EPL\Tottenham"
170,"La Liga\Real Madrid"
</pre>
</p>

<div class="note">ВАЖНО: Двойные кавычки обязательны для того, чтобы в названиях папок не было неопределенности.
Список всех номеров команд здесь: <a href="uni.txt">uni.txt</a> file</div>

<p>
Обратите внимание, что образец GDB (предоставляемый с Kitserver) - просто один из возможных способов организации команд и папок. Папка "EPL" используется для всех английских команд, "National" - для всех сборных, и т.д. Возможно вам более подойдет просто список папок без группировки. В этом случае просто соответственно измените map.txt и создайте удобную вам структуру папок. Гибкость организации форм - основное достоинство использования map.txt.
</p>

<p>
Из map.txt вы можете видеть, что для того, чтобы найти форму для команды #8, Kitserver должен пойти в папку <b>GDB\uni\National\France.</b> Эта папка будет содержать все доступные формы для команды #8. Внутри, вы должны создать отдельную папку для каждой формы. Как здесь:

<img src="france.jpg"/>

Для полевых игроков папка с 1-ой формой должна называться <b>pa</b>, со 2-ой - <b>pb</b>. Дополнительные формы должны быть в папках с названиями, начинающимися с буквы "p". Для того чтобы формы были отсортированы по алфафиту, удобно использовать для дополнительных форм префикс <b>"px-"</b>. Например, <b>px-blue</b>. Для вратарей, 1-я форма должна быть в папке <b>ga</b>, 2-я - в <b>gb</b>. Папки для дополнительных форм вратарей (что пока не поддерживается) могут иметь названия, начинающиеся с "g".
</p>

<div class="note">ВАЖНО: Имя папки действует, как своеобразный идентификатор для Kitserver, что налагает дополнительные ограничения на имена папок: они не могут содержать пробелы, желательно должны быть относительно короткими, и на английском, французском или других языках использовующих латиницу - Latin1 (iso8859-1). Чтобы быть уверенным, что Kitserver правильно найдет папку, используйте латинские буквы, цифры, знак подчеркивания, и тире (знак минус).
</div>

<p>
Теперь давайте перейдем к содержимому папки с формой. Возьмем <b>pa</b>, как пример.

<img src="pa.jpg" />

Вот как будет выглядеть папка, если в ней, так называемая форма "все в одной"  ("all-in-one"), это означает, что она не разделена на отдельные части: футболку, шорты и гетры. Kitserver может успешно работать как с раздельными, так и с формами all-in-one, т.к. он автоматически "делит" цельную форму на части прямо перед началом матча.  
</p>

<div class="note">
Чтобы китсервер мог правильно разделить "all-in-one" формы во время игры, ему необходима папка <b>masks</b>, находящаяся
внутри <b>uni</b>. Не удаляйте эту папку.</div>

<p>
Единственный случай, когда действительно нужна раздельная форма, это когда правила раздела формы на части нестандартны: как у вратарской формы Ювентуса с двумя разноцветными гетрами. Также вы можете использовать отдельные части, если у вас нет всех. Например, в папке <b>px-away2</b> Ньюкасла (Newcastle) нет all.png, а вместо этого есть shorts.png и socks.png. Примечательно, что там нет shirt.png: Kitserver будет использовать только шорты и гетры и возьмет футболку из другой папки.
</p>

<p>Подводя итог:</br>
Использование <b>all.png</b> равнозначно использованию <b>shirt.png</b>, <b>shorts.png</b>, and <b>socks.png</b>. (В общем, избегайте ситуации, когда в папке находятся все четыре из них, или <b>all.png</b> и, скажем, <b>shirt.png</b> - это быстро приведет к путанице).
</p>

<div class="note">Изображения могут быть как в PNG так и в BMP формате. Соответственно имена файлов должны иметь расширение ".png" или ".bmp". Нет ничего страшного в смешении форматов для одной формы, например, может быть такая комбинация файлов <b>shirt.bmp</b>, <b>shorts.png</b>, <b>socks.bmp.</b></div>

<p>
<table>
    <tr><th>Зарезервированное имя PNG-файла</th><th>Зарезервированное имя BMP-файла</th><th>Предназначение</th></tr>
    <tr><td>all.png</td><td>all.bmp</td><td>форма "all-in-one"</td></tr>
    <tr><td>shirt.png</td><td>shirt.bmp</td><td>футболка</td></tr>
    <tr><td>shorts.png</td><td>shorts.bmp</td><td>трусы</td></tr>
    <tr><td>socks.png</td><td>socks.bmp</td><td>гетры</td></tr>
    <tr><td>font.png</td><td>font.bmp</td><td>256x64 текстура со шрифтом, для изображения имени игрока на спине</td></tr>
</table>
</p>

<h3>2.3. config.txt</h3>

<p>
Это файл конфигурации атрибутов (в прошлых Kitserver-ах он назывался "attrib.cfg"). Как и прежде, это просто текстовый файл - вы можете использовать Блокнот (Notepad) или любой другой текстовый редактор для его просмотра и изменения. Каждая папка с футболкой (либо как с частью формы all-in-one, либо как с отдельным изображением) должна содержать свой config.txt внутри. Большая часть поддерживаемый аттрибутов относится к футболке, единственным исключением является - shorts.number.location. Поэтому, даже если у в папке находится только одно изображение с шортами, вам все равно понадобится config.txt - чтобы указать где на шортах должен быть расположен номер (слева, справа, на обеих сторонах, или должен вообще отсутствовать)</p>

<p>
Вот таблица со всеми поддерживаемыми атрибутами:
</p>

<table>
    <tr><th>
Название атрибута</th><th>Значение</th><th>Формат</th><th>Пример</th></tr>
    <tr>
        <td><b>model</b></td>
        <td>идентификатор для 3D модели футболки</td>
        <td>целое число (в десятичной системе счисления)</td>
        <td><nobr>model = 37</nobr></td>
    </tr>
    <tr>
        <td><b>collar</b></td>
        <td>присуствие воротника</td>
        <td>yes/no</td>
        <td><nobr>collar = no</nobr></td>
    </tr>
    <tr>
        <td><b>numbers</b></td>
        <td>имя файла (с путем относительно папки с формой) содержащего текстуру номеров: изображение 256x128 4bit/8bit с палитрой</td>
        <td>строка в двойных кавычках</td>
        <td><nobr>numbers = "..\num-white.png"</nobr></td>
    </tr>
    <tr>
        <td><b>shorts.num-pal.<span class="kitid">X</span></b></td>
        <td>имя файла (с путем относительно папки с формой) содержащего палитру номеров: изображение с 4bit/8bit палитрой. Это палитра, которая будет использована для шорт из папки с формой "X", если эти шорты используются с данной футболкой.</td>
        <td>строка в двойных кавычках</td>
        <td><nobr>shorts.num-pal.pb = "..\pal-black.png"</nobr></td>
    </tr>
    <tr>
        <td><b>shorts.number.location</b></td>
        <td>Позиция номера на трусах (Его можно отключить вообще: используйте значение "off").
        </td>
        <td>left|right|both|off</td>
        <td><nobr>shorts.number.location = left</nobr></td>
    </tr>
    <tr>
        <td><b>name.location</b></td>
        <td>Позиция фамилии игрока на спине. Этот атрибут полезен для тех команд, у которых
имена игроков на формы расположены в нижней части футболки. Как, например, у Boca Juniors. 
(Опять же используя значение "off", можно вообще убрать фамилию со спины.)</td>
        <td>top|bottom|off</td>
        <td><nobr>name.location = top</nobr></td>
    </tr>
    <tr>
        <td><b>logo.location</b></td>
        <td>Позиция эмблемы спонсора на спине. (Этот атрибут вряд ли будет полезен, так как
обычно эмблема спонсора является частью самой текстуры футболки.)</td>
        <td>top|bottom|off</td>
        <td><nobr>logo.location = off</nobr></td>
    </tr>
    <tr>
        <td><b>name.shape</b></td>
        <td>Индикатор того должно ли имя игрока на спине написано прямо, или слегка по кругу: Значения
соответствуют допустимым значиям из Edit Mode: type1 - прямая, type2 - небольшое искривление,
type3 - более заметное искривление.</td>
        <td>type1|type2|type3</td>
        <td><nobr>name.shape = type1</nobr></td>
    </tr>
    <tr>
        <td><b>radar.color</b></td>
	<td>Назначает цвет для радара. Пока что это аттрибут не всегда работает верно, но если интересно, попробуйте его использовать. (Устанавливая этот аттрибут, вы также меняете главный цвет для оригинальной мини-формы от Конами, а это влияет на то как игра выбирает формы по-умолчанию. В следующих версия китсервера, надеюсь что стабильность работы этого аттрибута будет налажена.</td>
        <td>цвет, в формате RRGGBB (red,green,blue)</td>
        <td><nobr>radar.color = 0A5D88</nobr></td>

    </tr>
	<tr>
        <td><b>description</b></td>
        <td>С помошью этого атрибута можно назначить произвольный пояснительный текст,
            который будет использован во время выбора форм. См. также ниже: 
        <a href="#kitinfoscreen">kit information</a></td>
        <td>строка в двойных кавычках</td>
        <td><nobr>description = "Home (UEFA Champions League)"</nobr></td>
    </tr>
    <tr>
        <td><b>mask</b></td>
        <td>Назначает файл маски, которая будет использоваться при "разрезании"
            формы во время смешения частей. Данный атрибут нужен только в ситуации
            когда раскройка происходит нестандартным образом. (См. секцию
            <a href="#kitmakernotes">На заметку китмейкерам</a> для более подробного
            описания.)</td>
        <td>строка в двойных кавычках</td>
        <td><nobr>mask = "mask_juve.png"</nobr></td>
    </tr>
</table>

<p>Для лучшего понимания использования <b>shorts.num-pal.<span class="kitid">X</span></b> изучите образцы config.txt файлов из GDB. Сначала это может выглядеть слишком запутано, однако, через некоторое время станет ясно, почему понадобился именно такой способ организации. (Главное, это подавить в себе фразу "ну... как тут все запущено...") Для того, чтобы иметь возможность свободно смешивать части форм, должна быть возможность указать, какие номера и с какой палитрой будут использованы на шортах во множенстве различных ситуаций.</p>

<p>
Например, рассмотрим config.txt из папки Germany <b>pa</b>:
<pre>
model = 37
collar = no

numbers = "..\..\adidas_black.png"

shorts.number.location = left
shorts.num-pal.pa = "..\..\adidas_white.png"
shorts.num-pal.pb = "..\..\adidas_black.png"
</pre>

<p>
Что означает:
Для футболки использовать номера Adidas (черные). Когда эта футболка используется с шортами из "pa", будет применен файл с палитрой "adidas_white.png", который воспроизведет белые номера на шортах. Когда эта же футболка используется с шортами "pb", будет применяться палитра из "adidas_black.png" и на шортах будут нарисованы черные номера.
</p>

<h3>2.4. Экран выбора форм и 2.5D-формы.</h3>

<p>
Для отображения форм из GDB (включая дополнительные) во время предматчевого выбора (Strip Selection), так называемые "2.5D" формы рисуются поверх миниформ от KONAMI. Название "2.5D" пошло от того, что формы двухмерные (т.е 2D), но они используют реальные текстуры, которые используются во время матча. Вот скриншот:


<img src="stripsel-pl.jpg" />

(Когда у команды нет формы в GDB, будет использована оригинальная миниформа KONAMI).
</p>

<p>
Вы можете переключаться между 1-ой и 2-ой формами, как и прежде, используя клавиатуру и геймпад, в зависимости от ваших установок. Для того чтобы получить доступ к дополнительным формам, нажмите кнопку "O" - вы войдете в режим "Change Setup". Маленькие желтые стрелки теперь будут изменять отдельные части формы, это позволит использовать дополнительные формы и их части. Все это входит в функциональные возможности игры, поэтому вам не понадобится нажимать какие-либо специальные клавиши для этого.</p>

<p>
Новой возможностью Kitserver является то, что выбирая другую футболку (шорты или гетры), теперь вы сможете поменять по кругу все доступные варианты, а не только части 1-ой и 2-ой форм.</p>

<p>
Кроме форм полевых игроков, вы также можете менять формы вратарей. Экран выбора форм теперь работает в двуж режимах: "Игроки" и "Вратари". Переключаться между режимами можно с помощью клавиши <b>[Tab]</b>. Также как и для игроков, для вратарей вы можете смешивать различные формы - если войдете в режим "Change Setup".
</p>

<img src="stripsel-gk.jpg" />

<a name="kitinfoscreen">
<p>
Внизу, под формами, отображается различная дополнительная информация. Разные модули 
используют это пространство по-разному, поэтому в каждый определенный момент, видна только
информация относящаяся к какому-то одному из модулей. Переключаться между разными
информационными блоками можно клавишами <b>[PAGE UP]</b> и <b>[PAGE DOWN]</b>. 
На данном примере показан блок "Kit information", который отображает текст "description"
атрибутов.
</p>

<img src="kitinfo.jpg" />

<p>
<div class="note">НА ЗАМЕТКУ: Ранние версии (5.1.0, 5.1.1) китсервера некорректно работали с некоторыми графическими картами.
В частности, проблемы были обнаружены с GeForce FX и GeForce 4 картами: мерцание экрана, сильное замедление работы при входе
в режим выбора форм, вместо 2.5d-форм отображались куски случайных текстур. Начиная с версии 5.1.2, это ошибка была исправлена. (Если все
же у вас она по-прежнему присутствует, попробуйте установить новый драйвера видеокарты от Nvidia).</div>
</p>

<h3 id="kitmakernotes">2.5 На заметку китмейкерам</h3>
<p>
Так-называемые High Definition Kits - основное новшество данной версии модуля. Можно смело 
экспериментировать с различными размерами текстур и "глубиной" изображения (количеством цветов).
К примеру, можно использовать текстуры 1024x512 или 2048x1028 - важно чтобы было сохранено
соотношение 2:1. 256-цветные текстуры с альфа каналом или без по-прежнему поддерживаются, но
кроме них теперь можно также использовать 32-битные изображения и 24-битные. В случае последних (24-битовых) Китсервер попытается загрузить альфа-канал из отдельного файла ("all-alpha.png" или "shirt-alpha.png" или соответствующих bmp-файлов). Если такой файл найден, порядковый номер цвета в палитре будет использован в качестве значения альфы в том же месте в текстуре. Пример такого файла с палитрой: alpha.pal (при его использовании, черный цвет с индексом 0 будет означать полную прозрачность,
а белый цвет с индексом 255 - полную непрозрачность). Если подобный файл палитры не найден - все пикселы будут интерпретированы как полностью непрозрачные.
</p>
<p>
<div class="note">На данной момент, только 256-цветные изображения могут служить в качестве alpha-файлов, но помните, что цвет как таковой не важен, а важен только его индекс в палитре. Все это вышесказанное про альфа-файлы, относится только к 24-битовым текстурам.</div>
</p>

<img src="mask.png" />
<p>
Несколько слов по-поводу "раскройки" форм на отдельные части. Как и раньше, это выполняется с
помощью файлов-масок, но формат масок изменен. Теперь все три части объединены в одну маску и 
обозначены разными цветами: красным (футболка), синим (шорты) и желтым (гетры). По-умолчанию,
используется файл <b>uni\masks\mask.png</b>. Однако Ювентус использует другое разбиение, и поэтому
Вам понадобится прописать атрибут "mask" для этих футболок. 
</p>

<p>Несмотря на все эти изменения, необходимо отметить что по-прежнему можно использовать
существующие 256-цветные текстуры, которые китсервер сам динамически конвертирует в 32-битные,
а также можно смешиваеть различные формы - вне зависимости от палитры и формата изображения. 
Важно не удалить папку "masks", так как без нее раскройка работать не будет.
</p>


<h2 id="ballserver">Ballserver Module 5.2.3</h2>

<h3>3.1 Краткий обзор возможностей модуля</h3>

<p>
<li><b>Выбор мяча на экране "Strip Selection".</b><br />
Пока просто текст названия мяча, но возможно в будующем появится "preview".
</li>
<li><b>Поддержка текстур разного размера.</b><br />
Можно использовать текстуры 256x256, 512x512 и даже 1024x1024 пикселов, в форматах PNG или BMP.</li>
</p>

<h3>3.2 Конфигурация GDB</h3>

<p>
Ballserver использует ту же самую папку GDB, что и остальные модули. Внутри папки GDB, теперь есть новая папка <b>balls</b>. Внутри нее, вы увидите файл со знакомым названием <b>map.txt</b> (похож на тот, что используется киствервером, но этот - для мячей). Формат очень прост: три аттрибута для каждого мяча. Первый - это имя, которое будет отображено во время выбора форм. Второй - имя файла модели мяча. Третий - имя текстуры мяча. Пример:
<pre>
# This is the configuration file for Ballserver
# Format: "&lt;name displayed in game&gt;","&lt;model file&gt;","&lt;texture file&gt;"
# Example: "adidas Finale Capitano Grey","ariel_mdl.bin","adidas_finale_capitano_grey.bmp"
# Texture paths are relative to GDB\balls\, model paths to GDB\balls\mdl\

# adidas
"adidas Finale Capitano Grey","ariel_mdl.bin","adidas_finale_capitano_grey.bmp"
"adidas Teamgeist Blue","gwidon_mdl.bin","adidas_teamgeist_blue.png"

# Nike

# Puma

# This comment makes sure you have pressed the enter key after the last ball
</pre>
Не забудьте двойные кавычки! (Иначе аттрибуты будут неверно прочитаны). Конфигурация, приведенная выше, позволяет выбрать между двумя новами мячами: <i>adidas Finale Capitano Grey</i> и <i>adidas Teamgeist Blue</i>. Текстуры должны находиться в папке "GDB\balls", а модели - в "GDB\balls\mdl".
</p><div class="note">Вы можете также организовать мячи в отдельные папки. В этом случае необходимо использовать относительные пути в именах файлов. Например,  <b>mysubfolder\tex.png</b>
для файла "tex.png" в папке "GDB\balls\mysubfolder".</div>

<p>
Скачивая разные мячи со многих сайтов, вы заметите, что большое количество мячей используют одну и ту же модель, а различаются только текстурами. В этои случае, вы можете использовать один и тот же файл модели для всех этих мячей. Модель не зависит от размера текстуры, и вы можете использовать текстуры разных размеров (256x256, 512x512, 1024x1024) с одной и той же моделью.
</p>

<h3>3.3 Выбор мяча</h3>
<p>
Во время выбора форм (Strip Selection) вы увидите текст, расположенный немного ниже самих форм: <b>"Ball: game choice"</b>. Это означает, что в матче будет использован мяч "по-умолчанию". Нажимая клавишу <b>B</b> на клавиатуре, вы можете выбрать следующий по порядку мяч из GDB. (или перебирать мячи в обратном порядке, с помощью клавиши <b>V</b>). Название мяча на экране должно измениться следующим образом: <b>"Ball: <i>&lt;имя мяча из map.txt&gt;</i>"</b> и тогда в матче вы должны увидеть этот мяч. Клавиша <b>R</b> выбирает мяч из списка случайным образом, а клавиша <b>C</b> - снова возвращает к "game choice".
</p>

<img src="ballsel.jpg" />

<p>
Если текст и мяч не отображены на экране, возможно Вам нужно переключить информационный блок
с помошью клавиш <b>[PAGE UP]</b> и <b>[PAGE DOWN]</b>, чтобы желтый текст внизу экрана
гласил "Ball selection"

<img src="ballsel2.jpg" />
</p>
<br />

<!-- ### FACESERVER ### -->

<h2 id="faceserver">FaceServer Module 5.2.3 (fserv.dll)</h2>

<h3>4.1 Введение</h3>
<p>
Фэйссервер (Faceserver) позволяет организовать файлы лиц и причесок в GDB, и
назначать их индивидуально каждому игроку. Бета-версия фэйссервера имела некоторые
проблемы с анимиционными вставками (например, замена игрока во время матча), а
также в Edit Mode. В данной версии модуля эти недочеты устранены. В настоящее
время пока нерешенной остается проблема повторов: идентификаторы игроков 
не сохраняются вместе с повторами, и поэтому фэйссервер не в состояние правильно
подменить лица и прически во время их просмотра (в режиме Museum). Но мы
работаем над новым модулем, который должен устранить и этот недостаток.
</p>


<h3>4.2 Как использовать</h3>
<p>В результате последних изменений, теперь можно просматривать то как выглядят лица
в режиме Edit Mode, и в верхней части экрана можно видеть следующую информацию об
игроке: его идентификатор, файл лица, файл прически.</p>

<img src="faceseditmode.jpg" />

<p>
Пример лица Давида Виллы изготовил Chris79. Идентификатор игрока также можно отыскать 
в файле PlayerList.txt, и это есть тот самый идентификатор, который нужно использовать
при конфигурации игрока в <b>map.txt</b>. Скопируйте BIN лица в папку <b>GDB\faces</b>.
В map.txt, добавьте новую строку - аналогично той, которая приведена в качестве примера в комментариях в заголовке файла (идентификатор игрока, запятая, файл лица в двойных кавычках). Имя файла
берется относительно папки GDB\faces, так что вы можете использовать свои дополнительные
папки внутри нее, чтобы организовать игроков по командам, или еще как-нибудь по своему
усмотрению. Конфигурация прически - аналогична, с той разницой, что нужно использовать
папку <b>GDB\hair</b>.</p>

<p>Во время матчей, лицо и прическа и игрока будут соответственно подменены. Не обращайте
внимание на то, что при редактирование игрока (в Edit Mode) его лицо и прическа сбрасываются
на стандартные - это просто показывает то, что изменения не сохраняются в options file.
Тем не менее, во время матча, лицо и прическа будут отображаться корректно.
</p>

<p>У многих пользователей были пробемы с нахождением файла PlayerList.txt. В принципе
он больше не нужен (так как идентификатор игрока можно определить в Edit Mode. См. выше).
Но в качестве справочной информации, этот файл может быть полезен. Китсервер создаст
PlayerList.txt после первого запуска игры с включенным фэйссервером. В данной версии
в этот файл добавлена новая информация, поэтому Вам <b>необходимо удалить старый
PlayerList.txt, иначе он не будет обновлен.</b></p>

<p>
Вы вероятно достаточно быстро обнаружите, что новые лица (вставленные фэйссервером) можно
выбирать в Edit Mode - они добавлены после существующих из AFS. Есть две причины, почему
этого делать <b>не следует</b>. Во-первых, подобное изменение будет сохранено в options
file, и это впоследствие может привести к проблемам если вы отключите фэйссервер или
вставите новые лица. Во вторых, номер лица, сохраняющегося в options file ограничено
числом 512. Если Вы будете конфигурировать лица (тоже самое относится и к прическам) с
помощью map.txt, то вышеуказанных траблов на возникнет. 
</p>

<div class="note">
Большинство вылетов (a.k.a. "crashes") происходит от неверной конфигурации map-файлов и
в случае дефектных BIN-файлов с лицами и прическами. В случае проблем, проверяйте эти
две вещи в первую очередь, ну а потом уже можно и на форумах ругаться :)
</div>


<!-- STADIUM SERVER -->

<h2 id="stadium">Stadium Server 5.2.3</h2>

<h3>5.1 Введение</h3>
<p>
Stadium Server - подключаемый модуль для Kitserver. Он позволяет
использовать дополнительные стадионы, содержащиеся в GDB и
организованные так же, как формы, мячи и лица.
</p>

</p><h3>5.2 Организация GDB</h3>

<div class="note">Эта секция в основном для создателей стадионов, чтобы
они могли организовать свои стадионы так, как необходимо для stadium
server. Для пользователей установка стадиона в этом случае будет очень
легкой - простое копирование папки.
</div>

<p>
Чтобы добавить новые стадионы в игру, вы должны организовать их особым способом в GDB.
В GDB теперь есть новая папка <b>stadiums</b>, которая содержит все дополнительные стадионы:
</p>

<img src="gdb.gif">

<p>Внутри папки <b>stadiums</b> каждый стадион нахоится в своей папке.
Например, Вы можете видеть здесь 4 стадиона (файл map.txt будет рассмотрен позже):
</p>

<img src="stadiums.gif">

<p>
</p><div class="note"> ВАЖНО: Имя папки будет использовано Stadium
Server будет использовано, как имя стадиона и в матчах, и в режиме
"View Stadiums".
</div>
<p></p>

<p>Внутри каждой папки стадиона структура директорий всегда одинакова.
Каждый стадион состоит из 68 файлов: 66 файлов для самого стадиона + 1
с текстурами рекламных щитов BIN + 1 файл с информацией (info.txt - год
строительства и вместимость стадиона содержатся здесь). 66 файлов
стадиона разделены на 6 папок - каждая используется для следующего
сценария: fine day, rainy day,
snowy day, fine night, rainy night, snowy night (ясный день, дождь,
снег, ясная ночь, дождь ночью, снег ночью). Папки называются:
<b>1_day_fine</b>, <b>2_day_rain</b>, <b>3_day_snow</b>, <b>4_night_fine</b>, <b>5_night_rain</b>,
и <b>6_night_snow</b>. Текстуры щитов BIN хранятся  папке под названием <b>adboards_tex</b>.
</p>

<img src="bernabeu.gif">

<p>
<b>info.txt</b> имеет очень простую структуру. Вы указыаете дату строительства и вместимость, а также город, как в примере ниже:
</p>

<pre># Stadium info file

built = 1999
capacity = 16500
city = Ramenskoye
</pre>

<p>Внутри каждой из 6 папок стадиона файлы имеют одинаковые
фиксированные имена, указывающие какую часть стадиона они содержат.
(Важно назвать файлы в каждой из 6 папок ТОЧНО, как показано на
картинке, потому что иначе stadium server не сможет загрузить стадион
правильно).
Например, вот содержимое папки <b>1_day_fine</b>:
</p>

<img src="dayfine.gif">

<p>
Несколько замечаний Gwidon про содержимое каждого из файлов: 
<table>
    <tbody><tr>
        <th>File</th><th>Comments</th>
    </tr>
    <tr>
        <td>crowd_a0.str</td>
        <td>Гостевые болельщики и флаги, при отсутствии гостевой поддержки (0-зв.)</td>
    </tr>
    <tr>
        <td>crowd_a1.str</td>
        <td>Гостевые болельщики и флаги, при слабой гостевой поддержке (1-зв.)</td>
    </tr>
    <tr>
        <td>crowd_a2.str</td>
        <td>Гостевые болельщики и флаги, при хорошей гостевой поддержке (2-зв.)</td>
    </tr>
    <tr>
        <td>crowd_a3.str</td>
        <td>Гостевые болельщики и флаги, при максимальной гостевой поддержке (3-зв.)</td>
    </tr>
    <tr>
        <td>crowd_h0.str</td>
        <td>Домашние болельщики и флаги, при отсутствии домашней поддержки (0-зв.)</td>
    </tr>
    <tr>
        <td>crowd_h1.str</td>
        <td>Домашние болельщики и флаги, при слабой домашней поддержке (1-зв.)</td>
    </tr>
    <tr>
        <td>crowd_h2.str</td>
        <td>Домашние болельщики и флаги, при хорошей домашней поддержке (2-зв.)</td>
    </tr>
    <tr>
        <td>crowd_h3.str</td>
        <td>Домашние болельщики и флаги, при максимальной домашней поддержке (3-зв.)</td>
    </tr>
    <tr>
        <td>stad1_main.bin</td>
        <td>Основной файл стадиона, с текстурами и моделями</td>
    </tr>
    <tr>
        <td>stad2_entrance.bin</td>
        <td>Начальная сцена</td>
    </tr>
    <tr>
        <td>stad2_adboards.bin</td>
        <td>Структура щитов</td>
    </tr>
</tbody></table>
</p>

<p>
В Папке <b>adboards_tex.bin</b> теперь всего один файл - <b>default.bin</b>,
в котором содержаться все текстуры, используемые для рекламных щитов во
время матча. (В будущем, эта папка сможет содержать и другие BIN с
текстурами, т.е. мы сможем использовать разные щиты в разных типах
матчей... Пока эта возможность не реализована.)
</p>

<img src="adbtex.gif">

<h3 id="stadiumimporter">5.3 Stadium Importer</h3>
<p>
В качестве вспомогательной утилиты для организации стадионов, поставляется
<b>stadimp.exe</b>. Она упрощает процесс импорта стадиона в базу GDB.
В принципе можно разобраться и вручную, однако утилита несколько ускоряет
монотонный процесс. Положите 66 файлов стадиона в папку <b>kitserver\stadimp\stadium</b>,
после чего добавьте туда также файл с рекламными щитами (его необходимо
назвать <b>adboards.bin</b>. Программа задаст несколько
наводящих вопросов о том как называется стадион, год создания, вместимость, и т.п.
и сама создаст файл "info.txt". После всего этого можно смело удалять папку
<b>stadimp</b>.
</p>

<h3>5.4 map.txt</h3>

<p>
<b>map.txt</b> в Stadium Server используется немного по другому в
сравнении с другими модулями (Kitserver или Ballserver, и т.д.). Чтобы
использовать стадион из GDB, совсем не обязателен файл map.txt. Однако,
он позволяет задать "home stadium" (домашний стадион) для команды.
Тогда, если Stadium Server в режиме "home team" (Вы можете переключать
его, нажимая клавишу <b>[7]</b>),
он сможет определить, какая команда играет дома, и попытаться загрузить
нужный стадион из GDB. Вот простой map.txt, с двумя командами, имеющими
домашние стадионы:
</p>

<pre># Stadium Server map file
# --------------------------------------------------------------
# This config maps team number into its home stadium folder name
# Format: <team-num>,"<folder name="">"
# Example: 170,"Santiago Bernabeu"

170,"Santiago Bernabeu"
184,"Saturn Ramenskoye"
</folder></team-num></pre>

<div class="note">ВАЖНО: Двойные кавычки обязательны, чтобы не
возникало неопределенности в имени папки. Чтобы узнать ID каждой из
команд, смотрите файл <a href="http://files5.webfile.ru/git/393765698/uni.txt">uni.txt</a> 
</div>

<h3>5.5. Режимы работы</h3>

<p>
На экране Strip Selection Вы сможете увидеть текст, указывающий
выбранный стадион (или режим), при этом будут доступны 4 новые горячие
клавиши <b>[7],[8],[9],[0]</b>:

</p><p>

<img src="selected.jpg">

</p>
<p>
<div class="note">
Маленькое изображение (preview) стадиона загружается из файла <b>preview.png</b> (или <b>preview.bmp</b>), если таковой имеется в папке стадиона.
</div>
</p>

<p>
У Stadium Server есть 2 режима работы при загрузке стадионов из GDB:
"selected stadium" (выбранный стадион) и "home team stadium" (домашний
стадион). Используя клавиши <b>[9]</b> и <b>[0]</b>, Вы можете передвигаться вперед и назад по доступным стадионам из GDB. <b>[8]</b> выберет случайный стадион из GDB. Нажимая <b>[7]</b>, вы переключаетесь между "game choice" (выбор по обычной логике игры) and "home
team stadium mode" (режим домашнего стадиона). Если выбран "game choice", используются стадионы из AFS.</p>

<img src="hometeam.jpg">

<h3>5.6. "View Stadiums"</h3>

<p>
Вы можете просмотреть все стадионы из GDB в режиме игры "View Stadiums". Для этого зайдите
в Options/Museum/View Stadiums и нажите клавишу <b>[1]</b>. Чтобы переключиться обратно
на стандартные стадионы, снова нажимайте [1]. Кроме того, можно выбирать
произвольную погоду с помощью клавиши <b>[2]</b> - это работает как для стадионов из
базы GDB, так и стандартных стадионов (из AFS).
</p>

<img src="viewstadiums.gif" />
<br />


<h2 id="lodmixer">LOD Mixer Module 5.2.3</h2>

<h3>6.1 Краткая справка</h3>

<p>
Китсервер теперь включает в себя новый модуль - LOD Mixer. Этот модуль позволяет произвести
некоторые изменения в конфигурации графического движка игры. Например, включить зрителей на
всех камерах, изменить таблицу уровней детализации (LOD), менять погоду/стадион и др. в 
режимах League/Cup/Master League.
</p>
<p>Для конфигурации модуля запустите <b>lodcfg.exe</b>. Скриншот того, как это выгдядит
(практически идентично более старой версии LOD Mixer - 1.6, которая распространяется в
качестве самостоятельной утилиты):
</p> 

<img src="lodmixer.gif"/>

<div class="NOTE">
    Более подробно про LOD Mixer можно прочитать здесь: <b><a href="lodmixer.txt">lodmixer.txt</a></b><br />
(К сожалению, пока только на английском)
</div>

<p>
Начиная с версии 5.2.3, вы можете управлять некоторыми настройками LOD-миксера
прямо в игре, если выберете соответствующую страницу (информационный блок) во время
экрана с выбором форм (как это сделать, <a href="#kitinfoscreen">объяснено здесь</a>):
</p>

<img src="lodingame.jpg"/>

<p>
Клавиши навигации следующие: <b>[1]</b> и <b>[2]</b> - выбор настройки (текущая
подсвечена желтым). <b>[+]</b> и <b>[-]</b> на числовой клавиатуре - смена значения
текущей настройки. Конфигурация сохраняется автоматически.
</p>


<h2>Некоторые аспекты конфигурации</h2>

<h3>7.1. Главный конфигурационный файл: kload.cfg</h3>

<p>
В большинстве случаев, Вам не понадобится модифицировать этот файл. Однако, если вы
хотите отключить какой-нибуль модуль, то это делается именно в этом файле - <b>kload.cfg</b>. Вот как он выглядит по-умолчанию:
</p>

<pre>
# Loader configuration file

gdb.dir = ".\"
DLL.num = 8
DLL.0 = "kitserver\zlib1.dll"
DLL.1 = "kitserver\libpng13.dll"
DLL.2 = "kitserver\kserv.dll"
DLL.3 = "kitserver\bserv.dll"
DLL.4 = "kitserver\fserv.dll"
DLL.5 = "kitserver\lodmixer.dll"
DLL.6 = "kitserver\stadium.dll"
DLL.7 = "kitserver\dxtools.dll"

# DirectX options
dx.force-SW-TnL = 0
dx.emulate-HW-TnL = 0
#dx.fullscreen.width = 1920
#dx.fullscreen.height = 1200
</pre>

<p>Первые два модуля - это стандартные библиотеки для поддержки изображений в формате PNG. Не
удаляйте эти модули. Последующие четыре модуля - это собственно сами модули китсервера, которые не зависят друг от друга и могут быть отключены и снова включены. Например, чтобы отключить модуль лиц (<b>kserv.dll</b>) - добавьте символ "#" в начало соответствующей строки:
</p>

<pre>
DLL.num = 8
DLL.0 = "kitserver\zlib1.dll"
DLL.1 = "kitserver\libpng13.dll"
#DLL.2 = "kitserver\kserv.dll"
DLL.3 = "kitserver\bserv.dll"
DLL.4 = "kitserver\fserv.dll"
DLL.5 = "kitserver\lodmixer.dll"
DLL.6 = "kitserver\stadium.dll"
DLL.7 = "kitserver\dxtools.dll"
</pre>

<p>
Опции <b>dx.force-SW-TnL</b> и <b>dx.emulate-HW-TnL</b> позволяют добиться того же эффекта, что и аналогичные установки в утилите 3DAnalyzer: "Force SW TnL" и "Emulate HW TnL Caps". Если у вас проблемы со стабильностью игры, но по какой-то причине вы не можете использовать 3DAnalyzer, попробуйте активировать эти установки.<br />
Чтобы включить эти опции, замените значение 0 на 1.
</p>

<p>
Две последнии опции - <b>dx.fullscreen.width</b> и <b>dx.fullscreen.height</b> - можно использовать чтобы "навязать" свое разрешение монитора в полноэкранном режиме. <i>Обратите внимание, что по-умолчанию, эти опции отключены (так как перед ними стоит знак комментария - '#'). Чтобы включить их, удалите знак комментария в обеих строках.</i></p> 


<h2>Над данной версией программы работали:</h2>

<p>
Программирование: <b>juce</b>, <b>Robbie</b><br />
Тестирование: <b>biker_jim_uk, ntalex, Gwidon, nt89</b><br />
Организация GDB и идея "home team stadium": <b>Gwidon</b><br>
Информация о стадионах в AFS: <b>nt89</b><br>
Формы: <b>Spark, kel, qiankun</b>.<br />
Мячи: <b>DAMned</b>.<br />
Модели мячей: <b>Ariel, Gwidon</b>.<br />
Лицо Давида Виллы: <b>Chris79</b>.<br />
Стадион "Сатурн Раменское": <b>Asiat</b><br>
Стадион "Santiago Bernabeu": <b>Gwidon</b><br>
<br />
Формы и мячи взяты здесь: <a href="http://www.wevolution.org">http://www.wevolution.org</a><br />
Шрифты, номера: авторы неизвестны. Изображения взяты с этого сайта: 
<a href="http://www.socsci.umn.edu/~jkoepp/pes5/">http://www.socsci.umn.edu/~jkoepp/pes5/</a>
и из самой игры.<br />
<br />
Документация: <br />
русский текст: <b>TriAn</b>, <b>juce</b><br />
немецкий текст: <b>Robbie</b><br />
английский текст: <b>juce</b>, <b>Robbie</b><br />
итальянский текст: <b>FabioS</b><br />
</p>

<p>
Kitserver использует следующие открытые библиотеки (open source software):<br />
<span class="soft">pngdib</span> by Jason Summers 
<a href="http://entropymine.com/jason/pngdib/">http://entropymine.com/jason/pngdib/</a><br />
<span class="soft">libpng</span> by Guy Eric Schalnat, Andreas Dilger, Glenn Randers-Pehrson, and others 
<a href="http://libpng.org/pub/png/libpng.html">http://libpng.org/pub/png/libpng.html</a><br />
<span class="soft">zlib</span> by Jean-loup Gailly and Mark Adler, and others
<a href="http://www.zlib.net/">http://www.zlib.net/</a><br />
</p>

</body>
</html>
